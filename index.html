<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Typing Tool - Vinkal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(45deg, #ffffff, #cccccc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #cccccc;
            font-size: 1.1rem;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #cccccc;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .typing-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .practice-text {
            font-size: 1.5rem;
            line-height: 2;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            min-height: 120px;
        }

        .char {
            position: relative;
        }

        .char.current {
            background: #ffffff;
            color: #000000;
            animation: blink 1s infinite;
        }

        .char.correct {
            background: #4ade80;
            color: #000000;
        }

        .char.incorrect {
            background: #ef4444;
            color: #ffffff;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .input-area {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-family: 'Courier New', monospace;
        }

        .input-area:focus {
            outline: none;
            border-color: #ffffff;
            background: rgba(255, 255, 255, 0.15);
        }

        .keyboard {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
            gap: 4px;
        }

        .key {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 12px;
            min-width: 45px;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #ffffff;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .key.active {
            background: #ffffff;
            color: #000000;
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .key.space {
            min-width: 300px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ffffff, #cccccc);
            color: #000000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.2);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-title {
            font-size: 2rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffffff, #cccccc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .result-label {
            color: #cccccc;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        .modal-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-top: 30px;
        }

        .copyright {
            color: #cccccc;
            font-size: 0.9rem;
        }

        .brand {
            font-weight: bold;
            color: #ffffff;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .logo {
                font-size: 2rem;
            }
            
            .practice-text {
                font-size: 1.2rem;
                padding: 15px;
            }
            
            .keyboard {
                padding: 10px;
            }
            
            .key {
                padding: 8px;
                min-width: 35px;
                font-size: 0.8rem;
            }
            
            .key.space {
                min-width: 200px;
            }
            
            .modal-content {
                padding: 20px;
                margin: 20px;
            }
        }

        .finger-guide {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .finger {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .finger.active {
            background: #ffffff;
            color: #000000;
        }

        /* Custom Text Modal Styles */
        .custom-text-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .custom-text-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            max-width: 600px;
            width: 90%;
        }

        .custom-text-content textarea {
            width: 100%;
            min-height: 200px;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #ffffff;
            font-size: 16px;
            font-family: 'Courier New', monospace;
            resize: vertical;
        }

        .custom-text-content textarea:focus {
            outline: none;
            border-color: #ffffff;
            background: rgba(255, 255, 255, 0.15);
        }

        /* Donate Button Styles */
        .donate-btn {
            position: fixed;
            right: 20px;
            bottom: 80px;
            z-index: 1000;
            background: linear-gradient(45deg, #ff4d4d, #ff944d);
            color: white;
            padding: 14px 24px;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            animation: pulse 1.8s infinite;
            transition: transform 0.3s;
        }

        .donate-btn:hover {
            transform: scale(1.1);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 77, 77, 0.5);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(255, 77, 77, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 77, 77, 0);
            }
        }

        @media (max-width: 768px) {
            .custom-text-content {
                padding: 20px;
                width: 95%;
            }

            .donate-btn {
                right: 10px;
                bottom: 60px;
                padding: 12px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">VINKAL TYPING TOOL</div>
            <div class="subtitle">Advanced Typing Performance Analyzer</div>
        </div>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value" id="wpm">0</div>
                <div class="stat-label">Words Per Minute</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="accuracy">100%</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="speed">0</div>
                <div class="stat-label">Chars/Min</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="count">0</div>
                <div class="stat-label">Characters</div>
            </div>
        </div>

        <div class="typing-area">
            <div class="practice-text" id="practiceText"></div>
            <input type="text" class="input-area" id="typingInput" placeholder="Start typing here..." disabled>
        </div>

        <div class="finger-guide">
            <div class="finger" data-finger="pinky-l">Left Pinky</div>
            <div class="finger" data-finger="ring-l">Left Ring</div>
            <div class="finger" data-finger="middle-l">Left Middle</div>
            <div class="finger" data-finger="index-l">Left Index</div>
            <div class="finger" data-finger="thumb">Thumbs</div>
            <div class="finger" data-finger="index-r">Right Index</div>
            <div class="finger" data-finger="middle-r">Right Middle</div>
            <div class="finger" data-finger="ring-r">Right Ring</div>
            <div class="finger" data-finger="pinky-r">Right Pinky</div>
        </div>

        <div class="keyboard">
            <div class="keyboard-row">
                <div class="key" data-key="`">~<br>`</div>
                <div class="key" data-key="1">!<br>1</div>
                <div class="key" data-key="2">@<br>2</div>
                <div class="key" data-key="3">#<br>3</div>
                <div class="key" data-key="4">$<br>4</div>
                <div class="key" data-key="5">%<br>5</div>
                <div class="key" data-key="6">^<br>6</div>
                <div class="key" data-key="7">&<br>7</div>
                <div class="key" data-key="8">*<br>8</div>
                <div class="key" data-key="9">(<br>9</div>
                <div class="key" data-key="0">)<br>0</div>
                <div class="key" data-key="-">_<br>-</div>
                <div class="key" data-key="=">+<br>=</div>
            </div>
            <div class="keyboard-row">
                <div class="key" data-key="q">Q</div>
                <div class="key" data-key="w">W</div>
                <div class="key" data-key="e">E</div>
                <div class="key" data-key="r">R</div>
                <div class="key" data-key="t">T</div>
                <div class="key" data-key="y">Y</div>
                <div class="key" data-key="u">U</div>
                <div class="key" data-key="i">I</div>
                <div class="key" data-key="o">O</div>
                <div class="key" data-key="p">P</div>
                <div class="key" data-key="[">{<br>[</div>
                <div class="key" data-key="]">}<br>]</div>
                <div class="key" data-key="\">|<br>\</div>
            </div>
            <div class="keyboard-row">
                <div class="key" data-key="a">A</div>
                <div class="key" data-key="s">S</div>
                <div class="key" data-key="d">D</div>
                <div class="key" data-key="f">F</div>
                <div class="key" data-key="g">G</div>
                <div class="key" data-key="h">H</div>
                <div class="key" data-key="j">J</div>
                <div class="key" data-key="k">K</div>
                <div class="key" data-key="l">L</div>
                <div class="key" data-key=";">:<br>;</div>
                <div class="key" data-key="'">"<br>'</div>
            </div>
            <div class="keyboard-row">
                <div class="key" data-key="z">Z</div>
                <div class="key" data-key="x">X</div>
                <div class="key" data-key="c">C</div>
                <div class="key" data-key="v">V</div>
                <div class="key" data-key="b">B</div>
                <div class="key" data-key="n">N</div>
                <div class="key" data-key="m">M</div>
                <div class="key" data-key=","><br>,</div>
                <div class="key" data-key=".">><br>.</div>
                <div class="key" data-key="/">?<br>/</div>
            </div>
            <div class="keyboard-row">
                <div class="key space" data-key=" ">SPACE</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" id="startBtn">Start Test</button>
            <button class="btn btn-secondary" id="resetBtn">Reset</button>
            <button class="btn btn-secondary" id="newTextBtn">New Text</button>
            <button class="btn btn-secondary" id="customTextBtn">Custom Text</button>
        </div>

        <div class="footer">
            <div class="copyright">
                Copyright © 2025 <span class="brand">Vinkal</span> | All Rights Reserved
            </div>
        </div>
    </div>

    <!-- Custom Text Modal -->
    <div class="modal" id="customTextModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Enter Custom Text</div>
                <div class="subtitle">Type or paste your own text for practice</div>
            </div>
            <textarea id="customTextInput" placeholder="Enter your custom text here..." style="width: 100%; min-height: 200px; margin: 20px 0; padding: 15px; background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 10px; color: #ffffff; font-size: 16px; font-family: 'Courier New', monospace; resize: vertical;"></textarea>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancelCustomTextBtn">Cancel</button>
                <button class="btn btn-primary" id="applyCustomTextBtn">Apply</button>
            </div>
        </div>
    </div>

    <!-- Donate Button -->
    <button class="donate-btn" onclick="window.open('https://www.buymeacoffee.com/vinkal', '_blank')" style="position: fixed; right: 20px; bottom: 80px; z-index: 1000; background: linear-gradient(45deg, #ff4d4d, #ff944d); color: white; padding: 14px 24px; border: none; border-radius: 30px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); animation: pulse 1.8s infinite; transition: transform 0.3s;">
        ❤️ Support Developer
    </button>

    <!-- Results Modal -->
    <div class="modal" id="resultsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Typing Performance Report</div>
                <div class="subtitle">Test completed successfully!</div>
            </div>
            
            <div class="results-grid">
                <div class="result-card">
                    <div class="result-value" id="finalWpm">0</div>
                    <div class="result-label">Words Per Minute</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="finalAccuracy">100%</div>
                    <div class="result-label">Accuracy</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="finalSpeed">0</div>
                    <div class="result-label">Chars/Min</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="finalCount">0</div>
                    <div class="result-label">Total Characters</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="finalCorrect">0</div>
                    <div class="result-label">Correct Keystrokes</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="finalMistakes">0</div>
                    <div class="result-label">Mistakes</div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-primary" id="downloadPdfBtn">Download PDF</button>
                <button class="btn btn-secondary" id="tryAgainBtn">Try Again</button>
                <button class="btn btn-secondary" id="closeModalBtn">Close</button>
            </div>
        </div>
    </div>

    <script>
        class TypingTool {
            constructor() {
                this.practiceTexts = [
                    "The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet and is perfect for typing practice.",
                    "as ds ad fd sa df as ds ad fd sa df as ds ad fd sa df as ds ad fd sa df as ds ad fd sa df as ds ad fd",
                    "Programming is the art of telling another human being what one wants the computer to do. It requires patience, logic, and creativity.",
                    "In a hole in the ground there lived a hobbit. Not a nasty, dirty, wet hole filled with the ends of worms and an oozy smell.",
                    "To be or not to be, that is the question. Whether tis nobler in the mind to suffer the slings and arrows of outrageous fortune.",
                    "jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl; jkl;",
                    "asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf asdf"
                ];
                
                this.currentText = '';
                this.currentIndex = 0;
                this.startTime = null;
                this.isActive = false;
                this.mistakes = 0;
                this.correctChars = 0;
                this.totalChars = 0;
                this.isTestRunning = false;
                
                this.fingerMap = {
                    'q': 'pinky-l', 'w': 'ring-l', 'e': 'middle-l', 'r': 'index-l', 't': 'index-l',
                    'y': 'index-r', 'u': 'index-r', 'i': 'middle-r', 'o': 'ring-r', 'p': 'pinky-r',
                    'a': 'pinky-l', 's': 'ring-l', 'd': 'middle-l', 'f': 'index-l', 'g': 'index-l',
                    'h': 'index-r', 'j': 'index-r', 'k': 'middle-r', 'l': 'ring-r', ';': 'pinky-r',
                    'z': 'pinky-l', 'x': 'ring-l', 'c': 'middle-l', 'v': 'index-l', 'b': 'index-l',
                    'n': 'index-r', 'm': 'index-r', ',': 'middle-r', '.': 'ring-r', '/': 'pinky-r',
                    ' ': 'thumb'
                };
                
                this.init();
            }
            
            init() {
                this.loadNewText();
                this.bindEvents();
                this.updateStats();
            }
            
            bindEvents() {
                const startBtn = document.getElementById('startBtn');
                const resetBtn = document.getElementById('resetBtn');
                const newTextBtn = document.getElementById('newTextBtn');
                const customTextBtn = document.getElementById('customTextBtn');
                const typingInput = document.getElementById('typingInput');
                const closeModalBtn = document.getElementById('closeModalBtn');
                const tryAgainBtn = document.getElementById('tryAgainBtn');
                const downloadPdfBtn = document.getElementById('downloadPdfBtn');
                const cancelCustomTextBtn = document.getElementById('cancelCustomTextBtn');
                const applyCustomTextBtn = document.getElementById('applyCustomTextBtn');
                
                startBtn.addEventListener('click', () => this.toggleTest());
                resetBtn.addEventListener('click', () => this.resetTest());
                newTextBtn.addEventListener('click', () => this.loadNewText());
                customTextBtn.addEventListener('click', () => this.openCustomTextModal());
                typingInput.addEventListener('input', (e) => this.handleInput(e));
                typingInput.addEventListener('keydown', (e) => this.handleKeyDown(e));
                closeModalBtn.addEventListener('click', () => this.closeModal());
                tryAgainBtn.addEventListener('click', () => this.tryAgain());
                downloadPdfBtn.addEventListener('click', () => this.downloadPDF());
                cancelCustomTextBtn.addEventListener('click', () => this.closeCustomTextModal());
                applyCustomTextBtn.addEventListener('click', () => this.applyCustomText());
                
                // Prevent context menu on typing input
                typingInput.addEventListener('contextmenu', (e) => e.preventDefault());
            }
            
            loadNewText() {
                const randomIndex = Math.floor(Math.random() * this.practiceTexts.length);
                this.currentText = this.practiceTexts[randomIndex];
                this.displayText();
                this.resetTest();
            }
            
            displayText() {
                const practiceTextEl = document.getElementById('practiceText');
                practiceTextEl.innerHTML = this.currentText
                    .split('')
                    .map((char, index) => `<span class="char" data-index="${index}">${char}</span>`)
                    .join('');
            }
            
            toggleTest() {
                if (!this.isTestRunning) {
                    this.startTest();
                } else {
                    this.stopTest();
                }
            }
            
            startTest() {
                this.isActive = true;
                this.isTestRunning = true;
                this.startTime = new Date();
                document.getElementById('typingInput').disabled = false;
                document.getElementById('typingInput').focus();
                document.getElementById('startBtn').textContent = 'Stop Test';
                document.getElementById('startBtn').classList.remove('btn-primary');
                document.getElementById('startBtn').classList.add('btn-secondary');
            }

            stopTest() {
                this.isActive = false;
                this.isTestRunning = false;
                document.getElementById('typingInput').disabled = true;
                document.getElementById('startBtn').textContent = 'Start Test';
                document.getElementById('startBtn').classList.remove('btn-secondary');
                document.getElementById('startBtn').classList.add('btn-primary');
            }
            
            resetTest() {
                this.isActive = false;
                this.isTestRunning = false;
                this.startTime = null;
                this.currentIndex = 0;
                this.mistakes = 0;
                this.correctChars = 0;
                this.totalChars = 0;
                
                document.getElementById('typingInput').value = '';
                document.getElementById('typingInput').disabled = true;
                document.getElementById('startBtn').textContent = 'Start Test';
                document.getElementById('startBtn').classList.remove('btn-secondary');
                document.getElementById('startBtn').classList.add('btn-primary');
                
                this.clearHighlights();
                this.updateStats();
                this.highlightCurrentChar();
            }
            
            handleInput(e) {
                if (!this.isActive) return;
                
                const inputValue = e.target.value;
                const currentChar = this.currentText[this.currentIndex];
                const typedChar = inputValue[inputValue.length - 1];
                
                if (inputValue.length > this.currentText.length) {
                    e.target.value = inputValue.slice(0, this.currentText.length);
                    return;
                }
                
                this.totalChars = inputValue.length;
                this.updateCharacterStatus(inputValue);
                this.updateStats();
                
                if (inputValue.length === this.currentText.length) {
                    this.completeTest();
                }
            }
            
            handleKeyDown(e) {
                if (!this.isActive) return;
                
                const key = e.key.toLowerCase();
                this.highlightKey(key);
                this.highlightFinger(key);
                
                // Prevent backspace beyond current progress
                if (e.key === 'Backspace' && e.target.selectionStart === 0) {
                    e.preventDefault();
                }
            }
            
            updateCharacterStatus(inputValue) {
                this.clearHighlights();
                this.correctChars = 0;
                this.mistakes = 0;
                
                for (let i = 0; i < inputValue.length; i++) {
                    const charEl = document.querySelector(`[data-index="${i}"]`);
                    const expectedChar = this.currentText[i];
                    const typedChar = inputValue[i];
                    
                    if (typedChar === expectedChar) {
                        charEl.classList.add('correct');
                        this.correctChars++;
                    } else {
                        charEl.classList.add('incorrect');
                        this.mistakes++;
                    }
                }
                
                this.currentIndex = inputValue.length;
                this.highlightCurrentChar();
            }
            
            highlightCurrentChar() {
                const currentCharEl = document.querySelector(`[data-index="${this.currentIndex}"]`);
                if (currentCharEl) {
                    currentCharEl.classList.add('current');
                }
            }
            
            clearHighlights() {
                document.querySelectorAll('.char').forEach(char => {
                    char.classList.remove('current', 'correct', 'incorrect');
                });
                
                document.querySelectorAll('.key').forEach(key => {
                    key.classList.remove('active');
                });
                
                document.querySelectorAll('.finger').forEach(finger => {
                    finger.classList.remove('active');
                });
            }
            
            highlightKey(key) {
                document.querySelectorAll('.key').forEach(keyEl => {
                    keyEl.classList.remove('active');
                });
                
                const keyEl = document.querySelector(`[data-key="${key}"]`);
                if (keyEl) {
                    keyEl.classList.add('active');
                    setTimeout(() => keyEl.classList.remove('active'), 200);
                }
            }
            
            highlightFinger(key) {
                document.querySelectorAll('.finger').forEach(finger => {
                    finger.classList.remove('active');
                });
                
                const fingerType = this.fingerMap[key];
                if (fingerType) {
                    const fingerEl = document.querySelector(`[data-finger="${fingerType}"]`);
                    if (fingerEl) {
                        fingerEl.classList.add('active');
                        setTimeout(() => fingerEl.classList.remove('active'), 200);
                    }
                }
            }
            
            updateStats() {
                const timeElapsed = this.startTime ? (new Date() - this.startTime) / 1000 / 60 : 0;
                const wpm = timeElapsed > 0 ? Math.round((this.correctChars / 5) / timeElapsed) : 0;
                const accuracy = this.totalChars > 0 ? Math.round((this.correctChars / this.totalChars) * 100) : 100;
                const speed = timeElapsed > 0 ? Math.round(this.correctChars / timeElapsed) : 0;
                
                document.getElementById('wpm').textContent = wpm;
                document.getElementById('accuracy').textContent = accuracy + '%';
                document.getElementById('speed').textContent = speed;
                document.getElementById('count').textContent = this.totalChars;
            }
            
            completeTest() {
                this.isActive = false;
                document.getElementById('typingInput').disabled = true;
                document.getElementById('startBtn').textContent = 'Test Completed';
                
                this.showResults();
            }
            
            showResults() {
                const timeElapsed = (new Date() - this.startTime) / 1000 / 60;
                const wpm = Math.round((this.correctChars / 5) / timeElapsed);
                const accuracy = Math.round((this.correctChars / this.totalChars) * 100);
                const speed = Math.round(this.correctChars / timeElapsed);
                
                document.getElementById('finalWpm').textContent = wpm;
                document.getElementById('finalAccuracy').textContent = accuracy + '%';
                document.getElementById('finalSpeed').textContent = speed;
                document.getElementById('finalCount').textContent = this.totalChars;
                document.getElementById('finalCorrect').textContent = this.correctChars;
                document.getElementById('finalMistakes').textContent = this.mistakes;
                
                document.getElementById('resultsModal').style.display = 'block';
            }
            
            closeModal() {
                document.getElementById('resultsModal').style.display = 'none';
            }
            
            tryAgain() {
                this.closeModal();
                this.resetTest();
            }
            
            downloadPDF() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                const timeElapsed = (new Date() - this.startTime) / 1000 / 60;
                const wpm = Math.round((this.correctChars / 5) / timeElapsed);
                const accuracy = Math.round((this.correctChars / this.totalChars) * 100);
                const speed = Math.round(this.correctChars / timeElapsed);
                
                // Header
                doc.setFontSize(20);
                doc.setFont(undefined, 'bold');
                doc.text('ADVANCED TYPING PERFORMANCE REPORT', 105, 30, { align: 'center' });
                
                // Date
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                const currentDate = new Date().toLocaleDateString();
                doc.text(`Date: ${currentDate}`, 20, 50);
                
                // Stats
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('Performance Statistics:', 20, 70);
                
                doc.setFont(undefined, 'normal');
                doc.text(`Total Characters: ${this.totalChars}`, 20, 90);
                doc.text(`Correct Keystrokes: ${this.correctChars}`, 20, 105);
                doc.text(`Mistakes: ${this.mistakes}`, 20, 120);
                doc.text(`Typing Speed: ${speed} chars/min`, 20, 135);
                doc.text(`Words Per Minute: ${wpm} WPM`, 20, 150);
                doc.text(`Accuracy: ${accuracy}%`, 20, 165);
                
                // Feedback
                doc.setFont(undefined, 'bold');
                doc.text('Feedback:', 20, 185);
                doc.setFont(undefined, 'normal');
                
                let feedback = '';
                if (accuracy >= 95 && wpm >= 40) {
                    feedback = 'Excellent! Outstanding typing performance.';
                } else if (accuracy >= 90 && wpm >= 30) {
                    feedback = 'Great job! Good balance of speed and accuracy.';
                } else if (accuracy >= 85) {
                    feedback = 'Good accuracy! Work on increasing your speed.';
                } else if (wpm >= 25) {
                    feedback = 'Good speed! Focus on improving accuracy.';
                } else {
                    feedback = 'Keep practicing! Focus on accuracy first, then speed.';
                }
                
                doc.text(feedback, 20, 200);
                
                // Footer
                doc.setFontSize(10);
                doc.text('Copyright © 2025 Vinkal | All Rights Reserved', 105, 280, { align: 'center' });
                
                // Save
                doc.save(`Typing-Report-${currentDate.replace(/\//g, '-')}.pdf`);
            }

            openCustomTextModal() {
                document.getElementById('customTextModal').style.display = 'block';
            }

            closeCustomTextModal() {
                document.getElementById('customTextModal').style.display = 'none';
                document.getElementById('customTextInput').value = '';
            }

            applyCustomText() {
                const customTextInput = document.getElementById('customTextInput').value.trim();
                if (customTextInput.length > 0) {
                    this.currentText = customTextInput;
                    this.displayText();
                    this.resetTest();
                    this.closeCustomTextModal();
                } else {
                    alert('Please enter some text before applying.');
                }
            }
        }
        
        // Initialize the typing tool when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new TypingTool();
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('resultsModal');
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    </script>
</body>
</html>